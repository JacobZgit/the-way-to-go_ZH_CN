# 11.6 ä½¿ç”¨æ–¹æ³•é›†ä¸æ¥å£

åœ¨[ç¬¬ 10.6.3 èŠ‚](10.6.md)åŠä¾‹å­ [methodset1.go](examples\chapter_10\methodset1.go) ä¸­æˆ‘ä»¬çœ‹åˆ°ï¼Œä½œç”¨äºå˜é‡ä¸Šçš„æ–¹æ³•å®é™…ä¸Šæ˜¯ä¸åŒºåˆ†å˜é‡åˆ°åº•æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼çš„ã€‚å½“ç¢°åˆ°æ¥å£ç±»å‹å€¼æ—¶ï¼Œè¿™ä¼šå˜å¾—æœ‰ç‚¹å¤æ‚ï¼ŒåŸå› æ˜¯æ¥å£å˜é‡ä¸­å­˜å‚¨çš„å…·ä½“å€¼æ˜¯ä¸å¯å¯»å€çš„ï¼Œå¹¸è¿çš„æ˜¯ï¼Œå¦‚æœä½¿ç”¨ä¸å½“ç¼–è¯‘å™¨ä¼šç»™å‡ºé”™è¯¯ã€‚è€ƒè™‘ä¸‹é¢çš„ç¨‹åºï¼š

ç¤ºä¾‹ 11.5 [methodset2.go](examples/chapter_11/methodset2.go)ï¼š

```go
package main

import (
	"fmt"
)

type List []int

func (l List) Len() int {
	return len(l)
}

func (l *List) Append(val int) {
	*l = append(*l, val)
}

type Appender interface {
	Append(int)
}

func CountInto(a Appender, start, end int) {
	for i := start; i <= end; i++ {
		a.Append(i)
	}
}

type Lener interface {
	Len() int
}

func LongEnough(l Lener) bool {
	return l.Len()*10 > 42
}

func main() {
	// A bare value
	var lst List
	// compiler error:
	// cannot use lst (type List) as type Appender in argument to CountInto:
	//       List does not implement Appender (Append method has pointer receiver)
	// CountInto(lst, 1, 10)
	if LongEnough(lst) { // VALID: Identical receiver type
		fmt.Printf("- lst is long enough\n")
	}

	// A pointer value
	plst := new(List)
	CountInto(plst, 1, 10) // VALID: Identical receiver type
	if LongEnough(plst) {
		// VALID: a *List can be dereferenced for the receiver
		fmt.Printf("- plst is long enough\n")
	}
}
```

**è®¨è®º**

åœ¨ `lst` ä¸Šè°ƒç”¨ `CountInto` æ—¶ä¼šå¯¼è‡´ä¸€ä¸ªç¼–è¯‘å™¨é”™è¯¯ï¼Œå› ä¸º `CountInto` éœ€è¦ä¸€ä¸ª `Appender`ï¼Œè€Œå®ƒçš„æ–¹æ³• `Append` åªå®šä¹‰åœ¨æŒ‡é’ˆä¸Šã€‚ åœ¨ `lst` ä¸Šè°ƒç”¨ `LongEnough` æ˜¯å¯ä»¥çš„ï¼Œå› ä¸º `Len` å®šä¹‰åœ¨å€¼ä¸Šã€‚

åœ¨ `plst` ä¸Šè°ƒç”¨ `CountInto` æ˜¯å¯ä»¥çš„ï¼Œå› ä¸º `CountInto` éœ€è¦ä¸€ä¸ª `Appender`ï¼Œå¹¶ä¸”å®ƒçš„æ–¹æ³• `Append` å®šä¹‰åœ¨æŒ‡é’ˆä¸Šã€‚ åœ¨ `plst` ä¸Šè°ƒç”¨ `LongEnough` ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæŒ‡é’ˆä¼šè¢«è‡ªåŠ¨è§£å¼•ç”¨ã€‚

**æ€»ç»“**

åœ¨æ¥å£ä¸Šè°ƒç”¨æ–¹æ³•æ—¶ï¼Œå¿…é¡»æœ‰å’Œæ–¹æ³•å®šä¹‰æ—¶ç›¸åŒçš„æ¥æ”¶è€…ç±»å‹æˆ–è€…æ˜¯å¯ä»¥æ ¹æ®å…·ä½“ç±»å‹ `P` ç›´æ¥è¾¨è¯†çš„ï¼š

- **æŒ‡é’ˆæ–¹æ³•å¯ä»¥é€šè¿‡æŒ‡é’ˆè°ƒç”¨**
- **å€¼æ–¹æ³•å¯ä»¥é€šè¿‡å€¼è°ƒç”¨**
- **æ¥æ”¶è€…æ˜¯å€¼çš„æ–¹æ³•å¯ä»¥é€šè¿‡æŒ‡é’ˆè°ƒç”¨ï¼Œå› ä¸ºæŒ‡é’ˆä¼šé¦–å…ˆè¢«è§£å¼•ç”¨**
- **æ¥æ”¶è€…æ˜¯æŒ‡é’ˆçš„æ–¹æ³•ä¸å¯ä»¥é€šè¿‡å€¼è°ƒç”¨ï¼Œå› ä¸ºå­˜å‚¨åœ¨æ¥å£ä¸­çš„å€¼æ²¡æœ‰åœ°å€**

å°†ä¸€ä¸ªå€¼èµ‹å€¼ç»™ä¸€ä¸ªæ¥å£æ—¶ï¼Œç¼–è¯‘å™¨ä¼šç¡®ä¿æ‰€æœ‰å¯èƒ½çš„æ¥å£æ–¹æ³•éƒ½å¯ä»¥åœ¨æ­¤å€¼ä¸Šè¢«è°ƒç”¨ï¼Œå› æ­¤ä¸æ­£ç¡®çš„èµ‹å€¼åœ¨ç¼–è¯‘æœŸå°±ä¼šå¤±è´¥ã€‚

**è¯‘æ³¨**

Go è¯­è¨€è§„èŒƒå®šä¹‰äº†æ¥å£æ–¹æ³•é›†çš„è°ƒç”¨è§„åˆ™ï¼š

- ç±»å‹ `*T` çš„å¯è°ƒç”¨æ–¹æ³•é›†åŒ…å«æ¥å—è€…ä¸º `*T` æˆ– `T` çš„æ‰€æœ‰æ–¹æ³•é›†
- ç±»å‹ `T` çš„å¯è°ƒç”¨æ–¹æ³•é›†åŒ…å«æ¥å—è€…ä¸º `T` çš„æ‰€æœ‰æ–¹æ³•
- ç±»å‹ `T` çš„å¯è°ƒç”¨æ–¹æ³•é›†**ä¸**åŒ…å«æ¥å—è€…ä¸º `*T` çš„æ–¹æ³•

#### è¿™é‡Œè§£é‡Šå¾—å¤ªç»•å£ï¼Œè¿˜æ˜¯å¼•ç”¨æ–‡ç« ï¼šhttps://www.cnblogs.com/kylin5201314/p/14944952.html

### å®ç°æ¥å£ï¼šæŒ‡é’ˆæ¥å—è€…ä¸å€¼æ¥å—è€…
```
package main

import "fmt"

type Describer interface {  
Describe()
}
type Person struct {  
name string
age  int
}

func (p Person) Describe() { // ä½¿ç”¨å€¼æ¥å—è€…å®ç°  
fmt.Printf("%s is %d years old\n", p.name, p.age)
}

type Address struct {
state   string
country string
}

func (a *Address) Describe() { // ä½¿ç”¨æŒ‡é’ˆæ¥å—è€…å®ç°
fmt.Printf("State %s Country %s", a.state, a.country)
}

func main() {  
var d1 Describer
p1 := Person{"Sam", 25}
d1 = p1
d1.Describe()
p2 := Person{"James", 32}
d1 = &p2
d1.Describe()

    var d2 Describer
    a := Address{"Washington", "USA"}

    /* å¦‚æœä¸‹é¢ä¸€è¡Œå–æ¶ˆæ³¨é‡Šä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼š
       cannot use a (type Address) as type Describer
       in assignment: Address does not implement
       Describer (Describe method has pointer
       receiver)
    */
    //d2 = a

    d2 = &a // è¿™æ˜¯åˆæ³•çš„
    // å› ä¸ºåœ¨ç¬¬ 22 è¡Œï¼ŒAddress ç±»å‹çš„æŒ‡é’ˆå®ç°äº† Describer æ¥å£
    d2.Describe()

}
```
åœ¨ä¸Šé¢ç¨‹åºä¸­çš„ç¬¬ 13 è¡Œï¼Œç»“æ„ä½“ Person ä½¿ç”¨å€¼æ¥å—è€…ï¼Œå®ç°äº† Describer æ¥å£ã€‚

**æˆ‘ä»¬åœ¨è®¨è®ºæ–¹æ³•çš„æ—¶å€™å°±å·²ç»æåˆ°è¿‡ï¼Œä½¿ç”¨å€¼æ¥å—è€…å£°æ˜çš„æ–¹æ³•ï¼Œæ—¢å¯ä»¥ç”¨å€¼æ¥è°ƒç”¨ï¼Œä¹Ÿèƒ½ç”¨æŒ‡é’ˆè°ƒç”¨**ã€‚ä¸ç®¡æ˜¯ä¸€ä¸ªå€¼ï¼Œè¿˜æ˜¯ä¸€ä¸ªå¯ä»¥è§£å¼•ç”¨çš„æŒ‡é’ˆï¼Œè°ƒç”¨è¿™æ ·çš„æ–¹æ³•éƒ½æ˜¯åˆæ³•çš„ã€‚

p1 çš„ç±»å‹æ˜¯ Personï¼Œåœ¨ç¬¬ 29 è¡Œï¼Œp1 èµ‹å€¼ç»™äº† d1ã€‚ç”±äº Person å®ç°äº†æ¥å£å˜é‡ d1ï¼Œå› æ­¤åœ¨ç¬¬ 30 è¡Œï¼Œä¼šæ‰“å° Sam is 25 years oldã€‚

æ¥ä¸‹æ¥åœ¨ç¬¬ 32 è¡Œï¼Œd1 åˆèµ‹å€¼ä¸º &p2ï¼Œåœ¨ç¬¬ 33 è¡ŒåŒæ ·æ‰“å°è¾“å‡ºäº† James is 32 years oldã€‚æ£’æ£’å“’ã€‚ğŸ˜ƒ

åœ¨ 22 è¡Œï¼Œç»“æ„ä½“ Address ä½¿ç”¨æŒ‡é’ˆæ¥å—è€…å®ç°äº† Describer æ¥å£ã€‚

åœ¨ä¸Šé¢ç¨‹åºé‡Œï¼Œå¦‚æœå»æ‰ç¬¬ 45 è¡Œçš„æ³¨é‡Šï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ç¼–è¯‘é”™è¯¯ï¼š```main.go:42: cannot use a (type Address) as type Describer in assignment: Address does not implement Describer (Describe method has pointer receiver)```ã€‚è¿™æ˜¯å› ä¸ºåœ¨ç¬¬ 22 è¡Œï¼Œæˆ‘ä»¬ä½¿ç”¨ Address ç±»å‹çš„æŒ‡é’ˆæ¥å—è€…å®ç°äº†æ¥å£ Describerï¼Œè€Œæ¥ä¸‹æ¥æˆ‘ä»¬è¯•å›¾ç”¨ a æ¥èµ‹å€¼ d2ã€‚ç„¶è€Œ a å±äºå€¼ç±»å‹ï¼Œå®ƒå¹¶æ²¡æœ‰å®ç° Describer æ¥å£ã€‚

**ä½ åº”è¯¥ä¼šå¾ˆæƒŠè®¶ï¼Œå› ä¸ºæˆ‘ä»¬æ›¾ç»å­¦ä¹ è¿‡ï¼Œä½¿ç”¨æŒ‡é’ˆæ¥å—è€…çš„æ–¹æ³•ï¼Œæ— è®ºæŒ‡é’ˆè¿˜æ˜¯å€¼éƒ½å¯ä»¥è°ƒç”¨å®ƒã€‚é‚£ä¹ˆä¸ºä»€ä¹ˆç¬¬ 45 è¡Œçš„ä»£ç å°±ä¸ç®¡ç”¨å‘¢ï¼Ÿ**

**å…¶åŸå› æ˜¯ï¼šå¯¹äºä½¿ç”¨æŒ‡é’ˆæ¥å—è€…çš„æ–¹æ³•ï¼Œç”¨ä¸€ä¸ªæŒ‡é’ˆæˆ–è€…ä¸€ä¸ªå¯å–å¾—åœ°å€çš„å€¼æ¥è°ƒç”¨éƒ½æ˜¯åˆæ³•çš„ã€‚ä½†æ¥å£ä¸­å­˜å‚¨çš„å…·ä½“å€¼ï¼ˆConcrete Valueï¼‰å¹¶ä¸èƒ½å–åˆ°åœ°å€ï¼Œå› æ­¤åœ¨ç¬¬ 45 è¡Œï¼Œå¯¹äºç¼–è¯‘å™¨æ— æ³•è‡ªåŠ¨è·å– a çš„åœ°å€ï¼Œäºæ˜¯ç¨‹åºæŠ¥é”™ã€‚**

ç¬¬ 47 è¡Œå°±å¯ä»¥æˆåŠŸè¿è¡Œï¼Œå› ä¸ºæˆ‘ä»¬å°† a çš„åœ°å€ &a èµ‹å€¼ç»™äº† d2ã€‚

ç¨‹åºçš„å…¶ä»–éƒ¨åˆ†ä¸è¨€è€Œå–»ã€‚è¯¥ç¨‹åºä¼šæ‰“å°ï¼š
```
Sam is 25 years old  
James is 32 years old  
State Washington Country USA
```
## é“¾æ¥

- [ç›®å½•](directory.md)
- ä¸Šä¸€èŠ‚ï¼š[æµ‹è¯•ä¸€ä¸ªå€¼æ˜¯å¦å®ç°äº†æŸä¸ªæ¥å£](11.5.md)
- ä¸‹ä¸€èŠ‚ï¼š[ç¬¬ä¸€ä¸ªä¾‹å­ï¼šä½¿ç”¨ Sorter æ¥å£æ’åº](11.7.md)
